{
    "name": "Randperm",
    "type": "COMPOSITE_OPERATION",
    "aliases": [
        "blank",
        "hierarch",
        "abstract"
    ],
    "description": [
        "Generates a tensor containing a random permutation of integers from 0 to n-1.",
        "Input \"n\" (Integer): The upper bound (exclusive) of the range of integers to permute. Must be a non-negative integer.",
        "Input \"dtype\" (torch.dtype, Optional): The desired data type of the output tensor. Default is `torch.int64`.",
        "Input \"layout\" (torch.layout, Optional): The desired layout of the output tensor. Default is `torch.strided`.",
        "Input \"device\" (torch.device, Optional): The desired device of the output tensor. Default is the current device.",
        "Input \"requires_grad\" (Boolean, Optional): If True, the returned tensor will be part of the computation graph and will require gradients. Default is False.",
        "Output (Tensor): A tensor containing a random permutation of integers from 0 to n-1, with the specified dtype, device, and layout.",
        "Notes: ",
        "The tensor is shuffled uniformly, meaning all permutations are equally likely., The function supports both CPU and GPU, depending on the specified `device`., Ensure that `n` is a non-negative integer; passing a negative value will result in an error.",
        "References: \"https://pytorch.org/docs/stable/generated/torch.randperm.html\""
    ],
    "inputs": [
        {
            "name": "N",
            "primitive_name": "Input"
        },
        {
            "name": "Seed",
            "primitive_name": "Input"
        }
    ],
    "outputs": [
        {
            "name": "Output",
            "primitive_name": "Output",
            "flow_state": "UNBOUND"
        }
    ],
    "operations": [
        {
            "name": "Append Scalar to 1D Array",
            "type": "COMPOSITE_OPERATION",
            "position": {
                "x": 341,
                "y": 61
            },
            "inputs": [
                {
                    "name": "1D Array",
                    "data": [
                        1
                    ],
                    "shape": [
                        1
                    ],
                    "type": "INTEGER",
                    "primitive_name": "1D Array",
                    "flow_state": "BOOT_SOURCE"
                },
                {
                    "name": "Scalar",
                    "primitive_name": "Scalar"
                }
            ],
            "outputs": [
                {
                    "name": "Output",
                    "primitive_name": "Output",
                    "flow_state": "UNBOUND"
                }
            ],
            "operations": [
                {
                    "name": "expand_one_dimension",
                    "primitive_name": "expand_one_dimension",
                    "type": "PRIMITIVE_OPERATION",
                    "position": {
                        "x": 563,
                        "y": 328
                    },
                    "inputs": [
                        {
                            "name": "input",
                            "primitive_name": "input"
                        },
                        {
                            "name": "dimension_index",
                            "data": 0,
                            "shape": [],
                            "type": "INTEGER",
                            "primitive_name": "dimension_index",
                            "flow_state": "BOOT_SOURCE"
                        }
                    ],
                    "outputs": [
                        {
                            "name": "output",
                            "primitive_name": "output",
                            "flow_state": "UNBOUND"
                        }
                    ]
                },
                {
                    "name": "concatenate",
                    "primitive_name": "concatenate",
                    "type": "PRIMITIVE_OPERATION",
                    "position": {
                        "x": 1241,
                        "y": 45
                    },
                    "inputs": [
                        {
                            "name": "array_1",
                            "shape": [
                                1
                            ],
                            "type": "INTEGER",
                            "primitive_name": "array_1",
                            "flow_state": "BOOT_SINK"
                        },
                        {
                            "name": "array_2",
                            "primitive_name": "array_2"
                        },
                        {
                            "name": "dimension_index",
                            "data": 0,
                            "shape": [],
                            "type": "INTEGER",
                            "primitive_name": "dimension_index",
                            "flow_state": "BOOT_SOURCE"
                        }
                    ],
                    "outputs": [
                        {
                            "name": "concatenated_array",
                            "primitive_name": "concatenated_array",
                            "flow_state": "UNBOUND"
                        }
                    ]
                }
            ],
            "links": [
                {
                    "source": {
                        "operation": "this",
                        "data": "Scalar"
                    },
                    "sink": {
                        "operation": "expand_one_dimension",
                        "data": "input"
                    },
                    "control_points": []
                },
                {
                    "source": {
                        "operation": "this",
                        "data": "1D Array"
                    },
                    "sink": {
                        "operation": "concatenate",
                        "data": "array_1"
                    },
                    "control_points": []
                },
                {
                    "source": {
                        "operation": "expand_one_dimension",
                        "data": "output"
                    },
                    "sink": {
                        "operation": "concatenate",
                        "data": "array_2"
                    },
                    "control_points": []
                },
                {
                    "source": {
                        "operation": "concatenate",
                        "data": "concatenated_array"
                    },
                    "sink": {
                        "operation": "this",
                        "data": "Output"
                    },
                    "control_points": []
                }
            ]
        },
        {
            "name": "swap_elements",
            "primitive_name": "swap_elements",
            "type": "PRIMITIVE_OPERATION",
            "position": {
                "x": 766,
                "y": 58
            },
            "inputs": [
                {
                    "name": "array",
                    "primitive_name": "array"
                },
                {
                    "name": "dimension_index",
                    "data": 0,
                    "shape": [],
                    "type": "INTEGER",
                    "primitive_name": "dimension_index",
                    "flow_state": "BOOT_SOURCE"
                },
                {
                    "name": "index_1",
                    "data": 0,
                    "shape": [],
                    "type": "INTEGER",
                    "primitive_name": "index_1",
                    "flow_state": "BOOT_SOURCE"
                },
                {
                    "name": "index_2",
                    "data": 1,
                    "shape": [],
                    "type": "INTEGER",
                    "primitive_name": "index_2",
                    "flow_state": "BOOT_SOURCE"
                }
            ],
            "outputs": [
                {
                    "name": "swapped_array",
                    "primitive_name": "swapped_array",
                    "flow_state": "UNBOUND"
                }
            ]
        },
        {
            "name": "generate_uniform_random_number",
            "primitive_name": "generate_uniform_random_number",
            "type": "PRIMITIVE_OPERATION",
            "position": {
                "x": 1194,
                "y": 263
            },
            "inputs": [
                {
                    "name": "shape",
                    "primitive_name": "shape"
                },
                {
                    "name": "random_seed",
                    "primitive_name": "random_seed"
                },
                {
                    "name": "left_limit",
                    "data": 0.0,
                    "shape": [],
                    "type": "DECIMAL",
                    "primitive_name": "left_limit",
                    "flow_state": "BOOT_SOURCE"
                },
                {
                    "name": "right_limit",
                    "data": 1.0,
                    "shape": [],
                    "type": "DECIMAL",
                    "primitive_name": "right_limit",
                    "flow_state": "BOOT_SOURCE"
                }
            ],
            "outputs": [
                {
                    "name": "random_number",
                    "primitive_name": "random_number",
                    "flow_state": "UNBOUND"
                }
            ]
        },
        {
            "name": "top_k",
            "primitive_name": "top_k",
            "type": "PRIMITIVE_OPERATION",
            "position": {
                "x": 1554,
                "y": 21
            },
            "inputs": [
                {
                    "name": "array",
                    "primitive_name": "array"
                },
                {
                    "name": "dimension_index",
                    "data": 0,
                    "shape": [],
                    "type": "INTEGER",
                    "primitive_name": "dimension_index",
                    "flow_state": "BOOT_SOURCE"
                },
                {
                    "name": "k",
                    "primitive_name": "k"
                }
            ],
            "input_order": [
                2,
                0,
                1
            ],
            "outputs": [
                {
                    "name": "top_k_array",
                    "primitive_name": "top_k_array",
                    "flow_state": "UNBOUND"
                },
                {
                    "name": "top_k_indices",
                    "primitive_name": "top_k_indices",
                    "flow_state": "UNBOUND"
                }
            ]
        }
    ],
    "links": [
        {
            "source": {
                "operation": "this",
                "data": "Seed"
            },
            "sink": {
                "operation": "generate_uniform_random_number",
                "data": "random_seed"
            },
            "control_points": []
        },
        {
            "source": {
                "operation": "this",
                "data": "N"
            },
            "sink": {
                "operation": "Append Scalar to 1D Array",
                "data": "Scalar"
            },
            "control_points": []
        },
        {
            "source": {
                "operation": "Append Scalar to 1D Array",
                "data": "Output"
            },
            "sink": {
                "operation": "swap_elements",
                "data": "array"
            },
            "control_points": []
        },
        {
            "source": {
                "operation": "swap_elements",
                "data": "swapped_array"
            },
            "sink": {
                "operation": "generate_uniform_random_number",
                "data": "shape"
            },
            "control_points": []
        },
        {
            "source": {
                "operation": "generate_uniform_random_number",
                "data": "random_number"
            },
            "sink": {
                "operation": "top_k",
                "data": "array"
            },
            "control_points": []
        },
        {
            "source": {
                "operation": "this",
                "data": "N"
            },
            "sink": {
                "operation": "top_k",
                "data": "k"
            },
            "control_points": [
                {
                    "x": 354,
                    "y": 39
                },
                {
                    "x": 728,
                    "y": 14
                }
            ]
        },
        {
            "source": {
                "operation": "top_k",
                "data": "top_k_indices"
            },
            "sink": {
                "operation": "this",
                "data": "Output"
            },
            "control_points": []
        }
    ],
    "global_constants": []
}
